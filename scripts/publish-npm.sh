#!/bin/bash

# ç¾å›¢å†…ç½‘å‘å¸ƒè„šæœ¬
# åœ¨å‘å¸ƒæ—¶ä¸´æ—¶ä½¿ç”¨ .mnpmrc é…ç½®ï¼Œå‘å¸ƒå®Œæˆåæ¢å¤

set -e

echo "ğŸš€ å¼€å§‹å‘å¸ƒåˆ°ç¾å›¢å†…ç½‘npm..."
# æ¸…ç†äº§ç‰©
echo "ğŸ§¹ æ¸…ç†äº§ç‰©..."
pnpm run clean

# æ„å»ºé¡¹ç›®
echo "ğŸ—ï¸  æ„å»ºé¡¹ç›®..."
pnpm build

# æ‰§è¡Œå‘å¸ƒå‰æ£€æŸ¥
echo "ğŸ” æ‰§è¡Œå‘å¸ƒå‰æ£€æŸ¥..."
node scripts/publish-check.cjs

# å‘å¸ƒï¼ˆè·³è¿‡ prepublishOnly é’©å­ï¼Œå› ä¸ºå·²ç»æ„å»ºè¿‡äº†ï¼‰
echo "ğŸ“¦ å‘å¸ƒåŒ…..."
pnpm changeset publish --ignore-scripts

echo "âœ… å‘å¸ƒå®Œæˆï¼"

echo "ğŸ‰ å‘å¸ƒæµç¨‹å®Œæˆï¼"
